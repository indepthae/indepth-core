
<% content_for :head do %>
  <%#= javascript_include_tag "applicant_registration" %>
  <%= javascript_include_tag "jquery-form" %>
  <%= stylesheet_link_tag 'jquery-ui_1.css' %>
<% end %>

<div id="content-header">
  <%= show_header_icon %>
  <h1><%= t('applicant') %></h1>
  <div class='header-sep'>|</div>
  <div class='sub-header'><%= t('new_applicant') %></div>

</div>
<div id="page-yield">
    <div id="flashmsg-div" style="width:100%; float: left;">
  <% unless flash[:notice].nil? %>
    <p class="flash-msg"> <%= flash[:notice] %> </p>
  <% end %>
  </div>
  <div id="selection-box">
    <%- form_remote_for :registration_course, :url=>show_form_applicants_path,:html=>{:method=>:post},:before=>"$('submit_button').disable(); Element.show('loader1');",:complete=>"on_complete()" do |f| -%>
      <div class="label-field-pair w400">
        <label for="student_grade"><%= t('course') %></label>

        <div class="text-input-bg">

          <%= f.select :course_id,
            @registration_courses.map {|b| b.display_name.present? ? [b.display_name, b.id] : [b.course.course_name, b.id]}.sort,
            {:prompt=>t('select_course')},
            {:onchange=>"#{remote_function(
            :url => { :action => 'show_course_instructions' },
            :with => "'registration_course_id='+value",
            :before => "Element.show('loader')",
            :success => "Element.hide('loader')"  )}"} %></div>
        <%= image_tag("loader.gif",:align => "absmiddle",:border => 0,:id => "loader", :style =>"display: none;margin-top:10px;" ) %>
      </div>
      <div id="instruction-box">
        <%= render :partial=>"applicants_admins/application_instructions" %>
      </div>
    <% end %>
  </div>
  <div id="form-box">

  </div>
</div>

<script type="text/javascript">
  
  function show_instructions() {

  }
  function toggle_relation_box(th_is){
    if(j(th_is).val()==="other"){
      var attr_name = j(th_is).attr("name")
      var attr_id = j(th_is).attr("id")
      j(th_is).parent().parent().find(".parent-relation").html('<div class="text-input-bg"><input id='+attr_id+' type="text" value="" size="30" name='+attr_name+'></div>');
      j(th_is).attr("name",j(th_is).attr("name").replace("[relation]","[relation_type]"));
    }
    else{
      j(th_is).attr("name",j(th_is).attr("name").replace("[relation_type]","[relation]"));
      j(th_is).parent().parent().find(".parent-relation").html('');
    }
  }
  function select_all_fields(th_is) {
    if (j(th_is).is(':checked')) {
      j(th_is).parent().parent().find(".active_batch_list").prop('checked', 'checked');
    }
    else {
      j(th_is).parent().parent().find(".active_batch_list").prop('checked', false);
    }
  }

  function toggle_field_selector(th_is) {
    var unchecked_box = j(th_is).parent().parent().find(".active_batch_list:checkbox:not(:checked)").length;
    if (unchecked_box === 0) {
      j(th_is).parent().parent().find(".select_all_check").prop('checked', 'checked');
    }
    else {
      j(th_is).parent().parent().find(".select_all_check").prop('checked', false);
    }
  }
  function on_complete(){
    j('#submit_button').enable();
    Element.hide('loader1');
    j(window).scrollTop(0,0);
  }   
</script>